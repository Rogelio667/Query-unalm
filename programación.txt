//Cantidad de cursos en un ciclo de pregrado segun Anexo Boletin
select ca.descripcion ciclo,count(distinct cu.nombre)cursos
from  aca_seccion s 
join aca_grupo_seccion gs on s.id_grupo_seccion = gs.id 
join aca_ciclo_academico ca on gs.id_ciclo = ca.id
join aca_curso cu on gs.id_curso = cu.id
join aca_anexo_boletin ab on gs.id_anexo_boletin = ab.id
join aca_anexo_boletin abb on ab.id_anexo_superior = abb.id
where ca.codigo in ('202300','202315','202310') 
and s.estado = 'ACT'
and gs.estado = 'ACT'
and abb.codigo in ('G01','G02','G03')
and gs.fecha_fin_modular is null
group by ca.descripcion;
